webpackJsonp([7],{HPC3:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={name:"userMgt",data:function(){return{searchName:"",styleData:{tableHeight:0,searchHeight:0},clickData:{},maindata:[],menuForm:{formTitle:"",formShow:!1,menuName:"",menuUrl:""}}},watch:{"$store.state.bodySize.height":function(t,e){this.styleData.tableHeight=this.$api.getHeightFun(-90),document.querySelector("#borderTable").style.height=this.styleData.tableHeight+"px"}},mounted:function(){this.searchFun(),this.styleData.tableHeight=this.$api.getHeightFun(-90),document.querySelector("#borderTable").style.height=this.styleData.tableHeight+"px"},methods:{toright:function(t){var e=this;this.maindata.forEach(function(i){i.resPid===t.resId&&(i.isshow=!1,e.toright(i)),i.resId===t.resId&&(i.direction="right")})},tobottom:function(t){this.maindata.forEach(function(e){e.resPid===t.resId&&(e.isshow=!0),e.resId===t.resId&&(e.direction="bottom")})},clickTreeName:function(t){"right"===t.direction?this.tobottom(t):this.toright(t)},searchFun:function(){var t=this;this.$api.promise({method:"POST",url:"findResource",data:{}}).then(function(e){console.log(e),e.data.code>0?(e.data.data.forEach(function(t){t.isshow=!1,t.direction="right",-1===t.resPid&&(t.isshow=!0)}),t.maindata=t.hasChildTree(t.sonsTree(e.data.data,-1)),console.dir(t.maindata)):t.$message.error(e.data.desc)}).catch(function(e){t.$message.error("接口异常："+e)})},sonsTree:function(t,e){var i=[];return function t(e,a,s){for(var n=0;n<e.length;n++){var r=e[n];r.resPid===a&&(r.lev=s,i.push(r),t(e,r.resId,s+1))}}(t,e,0),i},hasChildTree:function(t){return t.forEach(function(e,i){for(var a=0;a<t.length;a++)if(t[a].resPid===e.resId){e.hasChild=!0;break}}),t},getChildren:function(t){var e=[],i=this;return function t(a){i.maindata.forEach(function(i){i.resPid===a&&(e.push(i.resId),t(i.resId))})}(t),e},addMenu:function(t,e){this.menuForm={formTitle:"新增菜单",formShow:!0,menuName:"",menuUrl:""},this.clickData={index:t,data:e}},editMenu:function(t,e){},deleteMenu:function(t,e){},viewSaveFun:function(){var t=this,e={resPid:this.clickData.data.resId,resName:this.menuForm.menuName,resUrl:this.menuForm.menuUrl};this.$api.promise({method:"POST",url:"addResource",data:e}).then(function(e){console.log(e),e.data.code>0?(t.maindata.push(e.data.data),t.maindata=t.hasChildTree(t.sonsTree(t.maindata,-1)),t.tobottom(t.clickData.data)):t.$message.error(e.data.desc)}).catch(function(e){t.$message.error("接口异常："+e)}),this.menuForm.formShow=!1}}},s={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"menuMgt"},[i("div",{staticClass:"panel"},[i("div",{staticClass:"panel-heading"},[i("span",{staticStyle:{height:"40px","line-height":"40px"}},[t._v("菜单信息列表")]),t._v(" "),i("el-button",{staticStyle:{float:"right",margin:"4px 6px"},attrs:{type:"primary",size:"small",icon:"el-icon-plus"}},[t._v("新增菜单")])],1),t._v(" "),i("div",{staticClass:"panel-body"},[i("div",{staticClass:"demo-table",staticStyle:{padding:"10px"}},[t._m(0),t._v(" "),i("div",{staticStyle:{height:"0px","overflow-x":"auto"},attrs:{id:"borderTable"}},[i("table",{staticClass:"dataTable",attrs:{id:"dataTableTree",cellspacing:"0",cellpadding:"0",border:"0",width:"100%"}},[t._m(1),t._v(" "),i("tbody",{attrs:{id:"tbodyView"}},t._l(t.maindata,function(e,a){return i("tr",{directives:[{name:"show",rawName:"v-show",value:e.isshow,expression:"list.isshow"}],key:e.resId,class:{parentTd:-1===e.resPid}},[i("td",{staticStyle:{"padding-left":"15px"}},[i("div",{staticClass:"treeName",class:"lev"+e.lev,staticStyle:{"text-align":"left",cursor:"pointer"},on:{click:function(i){t.clickTreeName(e)}}},[i("i",{class:[e.hasChild?"el-icon-caret-"+e.direction:"iClassName"]}),t._v("\n                      "+t._s(e.resName)+"\n                    ")])]),t._v(" "),i("td",[t._v(t._s(e.resUrl))]),t._v(" "),i("td",[i("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:function(i){t.addMenu(a,e)}}},[t._v("新增下级")]),t._v(" "),i("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-edit"},on:{click:t.editMenu}},[t._v("编辑")]),t._v(" "),i("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:t.deleteMenu}},[t._v("删除")])],1)])}))])])])])]),t._v(" "),i("el-dialog",{attrs:{title:t.menuForm.formTitle,visible:t.menuForm.formShow,width:"400px"},on:{"update:visible":function(e){t.$set(t.menuForm,"formShow",e)}}},[i("el-form",{attrs:{size:"small","label-width":"80px"}},[i("el-form-item",{attrs:{label:"菜单名称",prop:"username"}},[i("el-input",{staticStyle:{width:"215px"},attrs:{clearable:""},model:{value:t.menuForm.menuName,callback:function(e){t.$set(t.menuForm,"menuName",e)},expression:"menuForm.menuName"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"路径"}},[i("el-input",{staticStyle:{width:"215px"},attrs:{clearable:""},model:{value:t.menuForm.menuUrl,callback:function(e){t.$set(t.menuForm,"menuUrl",e)},expression:"menuForm.menuUrl"}})],1)],1),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.viewSaveFun()}}},[t._v("确 定")]),t._v(" "),i("el-button",{attrs:{size:"mini"},on:{click:function(e){t.menuForm.formShow=!1}}},[t._v("取 消")])],1)],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{position:"relative"}},[e("div",{staticStyle:{position:"absolute",left:"0px",top:"0px","background-color":"#fff",width:"100%","z-index":"999"}},[e("table",{staticClass:"dataTable",attrs:{cellspacing:"0",cellpadding:"0",border:"0",width:"100%"}},[e("thead",[e("tr",[e("td",{attrs:{width:"200"}},[this._v("菜单名称")]),this._v(" "),e("td",{attrs:{width:"300"}},[this._v("路径")]),this._v(" "),e("td",{attrs:{width:"300"}},[this._v("操作")])])])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("td",{attrs:{width:"200"}},[this._v("菜单名称")]),this._v(" "),e("td",{attrs:{width:"300"}},[this._v("路径")]),this._v(" "),e("td",{attrs:{width:"300"}},[this._v("操作")])])])}]};var n=i("VU/8")(a,s,!1,function(t){i("ZSZY")},null,null);e.default=n.exports},ZSZY:function(t,e){}});